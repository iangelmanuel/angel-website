---
import { Button, buttonVariants } from "@/components/ui/button"
import {
  ArrowDown,
  Download,
  Github,
  Linkedin,
  Mail,
  Twitter
} from "lucide-react"
import { siteInfo } from "@/const/site-info"
import type { LanguageData } from "@/types/language"
import { Badge } from "@/components/ui/badge"

type Props = {
  t: LanguageData
}

const { t } = Astro.props
const currentLang = Astro.currentLocale || "es"
---

<section
  class="compact-section m-0 flex items-center justify-center overflow-hidden pt-20 sm:h-screen sm:pt-24"
>
  <div
    class="container-width z-10 flex flex-col items-center gap-5 text-center sm:gap-8"
  >
    <div class="relative">
      <div
        class="mx-auto size-48 overflow-hidden rounded-full border-4 border-white shadow-2xl sm:size-80 dark:border-black"
      >
        <img
          src="/img/profile-photo.webp"
          alt="Angel De La Torre profile photo"
          class="h-full w-full object-cover"
        />
      </div>
      <Badge
        variant="secondary"
        className="absolute -right-2 -bottom-2 rounded-full border sm:-right-1 sm:bottom-5"
      >
        <span class="sm:text-normal text-sm font-medium">{t.hero.yearExp}</span>
      </Badge>
    </div>

    <div class="order-1 max-w-2xl space-y-4 sm:order-2">
      <Badge
        className="bg-secondary text-foreground m-0 inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs sm:px-4 sm:py-2 sm:text-sm"
      >
        <span class="relative flex h-2 w-2 sm:h-3 sm:w-3">
          <span
            class:list={[
              "absolute inline-flex h-full w-full animate-ping rounded-full opacity-75",
              siteInfo.available ? "bg-green-500" : "bg-red-500"
            ]}></span>
          <span
            class:list={[
              "relative inline-flex h-2 w-2 rounded-full sm:h-3 sm:w-3",
              siteInfo.available ? "bg-green-500" : "bg-red-500"
            ]}></span>
        </span>
        {t.hero.available.label}
      </Badge>

      <h1
        class="text-2xl font-light tracking-tight sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl"
      >
        {t.hero.greeting}
        {siteInfo.authorName}
        <span class="animate-wave inline-block">ðŸ‘‹</span>
      </h1>

      <h2
        class="text-muted-foreground font-light sm:text-lg md:text-xl lg:text-2xl"
      >
        {t.hero.title}
      </h2>

      <p
        set:html={t.hero.description}
        class="text-muted-foreground mx-auto max-w-xl text-sm leading-relaxed font-light sm:text-base"
      />

      <div
        class="flex flex-col items-center justify-center gap-3 pt-4 sm:flex-row sm:gap-4"
      >
        <a
          href="#projects"
          class:list={[buttonVariants(), "w-full sm:w-auto"]}
        >
          <ArrowDown className="size-4" />
          {t.hero.btn1}
        </a>

        <Button
          id="download-cv"
          variant="outline"
          data-lang={currentLang}
          className="w-full sm:w-auto"
        >
          <Download className="w-full sm:w-auto" />
          {t.hero.btn2}
        </Button>
      </div>

      <div class="flex items-center justify-center gap-5 pt-4">
        <a
          href={siteInfo.social.github}
          target="_blank"
          rel="noopener noreferrer"
          class="text-muted-foreground hover:text-foreground p-2 transition-colors"
        >
          <Github className="h-5 w-5 sm:h-6 sm:w-6" />
          <span class="sr-only">GitHub</span>
        </a>
        <a
          href={siteInfo.social.linkedin}
          target="_blank"
          rel="noopener noreferrer"
          class="text-muted-foreground hover:text-foreground p-2 transition-colors"
        >
          <Linkedin className="h-5 w-5 sm:h-6 sm:w-6" />
          <span class="sr-only">LinkedIn</span>
        </a>
        <a
          href={siteInfo.social.x}
          target="_blank"
          rel="noopener noreferrer"
          class="text-muted-foreground hover:text-foreground p-2 transition-colors"
        >
          <Twitter className="h-5 w-5 sm:h-6 sm:w-6" />
          <span class="sr-only">Twitter</span>
        </a>
        <a
          href={`mailto:${siteInfo.email}`}
          class="text-muted-foreground hover:text-foreground p-2 transition-colors"
        >
          <Mail className="h-5 w-5 sm:h-6 sm:w-6" />
          <span class="sr-only">Email</span>
        </a>
      </div>
    </div>
  </div>
</section>

<script>
  import { $ } from "@/lib/dom-selector"

  document.addEventListener("astro:page-load", () => {
    const $downloadBtn = $("#download-cv") as HTMLButtonElement
    const lang = $downloadBtn.dataset.lang || "es"

    const spanishCv = "cv-angel-dm.pdf"
    const englishCv = "cv-angel-dm-en.pdf"

    $downloadBtn.addEventListener("click", () => {
      const fileName = lang === "es" ? spanishCv : englishCv
      const fileUrl = `/docs/${fileName}`

      const link = document.createElement("a")
      link.href = fileUrl
      link.download = fileName
      document.body.appendChild(link)
      link.click()
      document.body.removeChild(link)
    })
  })
</script>
